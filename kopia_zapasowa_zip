#Projekt: Kopia zapasowa folderu do pliku ZIP
#Załóżmy, że pracujesz nad projektem, którego pliki przechowujesz w folderze o nazwie C:\AlsPythonBook. Obawiasz się utraty swojej pracy, więc chciałbyś tworzyć pliki ZIP z "migawkami" całego folderu. Chciałbyś mieć różne wersje, więc chcesz, aby nazwa pliku ZIP była inkrementowana za każdym razem, gdy jest tworzony; na przykład AlsPythonBook_1.zip, AlsPythonBook_2.zip, AlsPythonBook_3.zip i tak dalej. Możesz to zrobić ręcznie, ale jest to dość uciążliwe i możesz przypadkowo błędnie ponumerować nazwy plików ZIP. Znacznie prościej byłoby uruchomić program, który wykona to nudne zadanie za ciebie.

#Dla tego projektu otwórz nowe okno edytora plików i zapisz go jako backupToZip.py.

#Krok 1: Określenie nazwy pliku ZIP
#Kod dla tego programu zostanie umieszczony w funkcji o nazwie backupToZip(). To ułatwi kopiowanie i wklejanie funkcji do innych programów Pythona, które potrzebują tej funkcjonalności. Na końcu programu funkcja zostanie wywołana, aby wykonać kopię zapasową. Twój program powinien wyglądać tak:

#Krok 2 Teraz, gdy nowa nazwa pliku ZIP jest przechowywana w zmiennej zipFilename, możesz wywołać zipfile.ZipFile(), aby faktycznie utworzyć plik ZIP. Upewnij się, że jako drugi argument podasz 'w', aby plik ZIP został otwarty w trybie zapisu.

#Krok3 Teraz musisz użyć funkcji os.walk(), aby wykonać zadanie polegające na wymienieniu każdego pliku w folderze i jego podfolderach. Twój program powinien wyglądać tak:



import zipfile, os


def backupToZip(folder):
    folder = os.path.abspath(folder)  # upewnij się, że folder jest absolutny

    number = 1
    while True:
        zipFilename = os.path.basename(folder) + '_' + str(number) + '.zip'
        if not os.path.exists(zipFilename):
            break
        number = number + 1

    # Utwórz plik ZIP.
    print(f'Tworzenie {zipFilename}...')
    backupZip = zipfile.ZipFile(zipFilename, 'w')

    # Przejdź przez cały folder i skompresuj pliki w każdym folderze.
    for foldername, subfolders, filenames in os.walk(folder):
        print(f'Dodawanie plików w {foldername}...')
        # Dodaj bieżący folder do pliku ZIP.
        backupZip.write(foldername)

        # Dodaj wszystkie pliki w tym folderze do pliku ZIP.
        for filename in filenames:
            newBase = os.path.basename(folder) + '_'
            if filename.startswith(newBase) and filename.endswith('.zip'):
                continue  # nie twórz kopii zapasowej plików ZIP z kopią zapasową
            backupZip.write(os.path.join(foldername, filename))

    backupZip.close()
    print('Gotowe.')

backupToZip('C:\\AlsPythonBook')
